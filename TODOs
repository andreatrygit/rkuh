favicon.ico
verificare che il purge sui js e' lestensione giusta
prima il comando di build dei template
bloccare sotto IE 11 con alpine
can i set cookie when sending a frame?
add semantics to composer
gestione del hide dell'header/barra
metto @logout su composer
vercel timeout
header in rem
toasts
frame semantics partendo da /? su landing
launch toast if localstorage fails
mettere tutti gli effetti di logout
themer buttons flicker
menu content x-if oppure src ""
menu slug vuoto o scorretto
tutti gli eventi .window
device pairing  5. check force site 6. test all
apple svgs
se fallisce il pairing tolgo il cookie comunque
tough cookies
; dopo html chars
header in rem
prevent zoom
dependency versions in imports with CDN
settare cookie su login
memorizzare il theme nel db
testare http error e timeout in landing
prevent zoom
prevent overscrool in index
fix header icons on safari
fix responsiveness on safari
test pinjs
cambia lo url di ky quando finisci il file test
controlla tutti gli url
perché $el di alpine è un Dom node ma non un html element??
pin specific version of alpine and not 3.x.x in prod
test double QR code
pouya on button pad
__Host- cookie prefix e rivedi tough cookies
cookie gdpr
cancel timeclock interval su timeclock landing func..howto? usa destroy() in  x-data: è undocumented
cdn sri
check dependency in skypack: are they fork??
il timeout globale di 3 min non sembra funzionare se c'è un focus
barra orizzontale con grande frame in desktop
studia classi su index ed eventualmente riscrivile
operazioni atomiche sui frames
encrypted connection to neo4j with encryption option at driver instantiation with js
const func export?

switch to require
test app with cookies
refactor app
complete form errors
check all appid and appid list spelling
!!! require mechanism spoils files with success from daisyui

***
refactor globale di kypost
metti html di default per gli errori di kyframe
verifica bene i callback di kydata e kyframe in relazione agli errori di miro
decora transizioni e reload dei frames
scrivi datajs e framejs con 2 mapper
usa empty:

driver creation error
transaction error
transaction data error: differentiate by case
neo client timeout
vercel timeout
http error

api
    \frames
        \site
            \home
            \landing
            \pairing
        \app
    \data

metti il timeout del client a 200 secondi e la expiration dei cookies a 180 secondi, così per i frame, se arriva una richiesta valida il frame server può rispondere senza dubbi

per cancellare cookies
res.setHeader('Set-Cookie',[toughCookie(('rkuh_session-appid_'+req.query.appid),'',-1)]); //TODO cancella anche sul db

 res.setHeader('Set-Cookie',[toughCookie(('rkuh_session-appid_'+req.query.appid),'@@@@@',3*60)]); //TODO anche sul db
    res.status(200).json({"info":"logged-in: personal"});
  }
  else
  {
    res.status(200).json({"error":"wrong PIN"});


    pairing HTML

const baseString =
`<!DOCTYPE html>`+
`<html lang="en">`+
`<head>`+
    `<meta name="description" content="Rkuh Device Pairing" />`+
    `<meta charset="utf-8">`+
    `<title>Rkuh Device Pairing</title>`+
    `<meta name="viewport" content="width=device-width, initial-scale=1">`+
    `<meta name="author" content="Andrea Scotti">`+
    `<link rel="stylesheet" type="text/css" href="../../../../global.css">`+
`<head>`;

const successString =
`<body>`+
    `<div class="w-screen h-screen p-4 flex flex-col flex-nowrap justify-center items-center space-y-5 md:space-y-10">`+
        `<div class="text-6xl md:text-9xl animate-bounce">&#128516</div>`+
        `<div class="text-4xl md:text-6xl text-center">Questo dispositivo è ora associato ad Rkuh!</div>`+
        `<a href="../../../.." class="btn btn-primary btn-large">EFFETTUA L&#39&nbspACCESSO</a>`+
    `</div>`+
`</body>`;

const failureString =
`<body>`+
    `<div class="w-screen h-screen p-4 flex flex-col flex-nowrap justify-center items-center space-y-5 md:space-y-10">`+
        `<div class="text-6xl md:text-9xl animate-bounce">&#128562</div>`+
        `<div class="text-4xl md:text-6xl text-center">Qualcosa non va...questo dispositivo NON è stato associato ad Rkuh!</div>`+
        `<a href="../../../.." class="btn btn-primary btn-large">VAI ALLA HOME PAGE</a>`+
    `</div>`+
`</body>`;


reading from FS also with replacing functionality

const { readFileSync } = require('fs')

module.exports = (req, res) => {

  switch(req.cookies['__Host-rkuh_device']){
    case 'timeclock':
      res.status(200).send(readFileSync("src/lambdas/templates-html/landing/timeclock-device.html", 'utf8'));
      break;
    case 'shared':
      res.status(200).send(readFileSync("src/lambdas/templates-html/landing/shared-device.html", 'utf8'));
      break;
    case 'personal':
      if (req.query['force_site']==='1') {
        const tempString = readFileSync("src/lambdas/templates-html/landing/visitor-device.html", 'utf8');
        const finalString = tempString.replace('?_vercel_no_cache=1','?force_site=1&_vercel_no_cache=1'); //replacing
        res.status(200).send(finalString);  
      } else {
        res.status(200).send(readFileSync("src/lambdas/templates-html/landing/personal-device.html", 'utf8'));
      }
      break;  
    default:
      res.status(200).send(readFileSync("src/lambdas/templates-html/landing/visitor-device.html", 'utf8'));
      break;  
  }
  
}

res.setHeader('Set-Cookie',[toughCookie(('rkuh_session-appid_'+req.query.appid),'@@@@@',3*60)]); //TODO anche sul db
    res.status(200).json({"info":"logged-in: personal"});